<script th:fragment="js" th:inline="javascript" type="text/javascript">

$(document).ready(function(){
	console.log("DOCUMENT READY!!");
	
	init_events();
	
});

function memberModifyForm() {
	console.log('memberModifyForm() CALLED!!');
	
	let form = document.member_modify_form;
	if (form.m_name.value==''){
		alert('INPUT NAME');
		form.m_name.focus();
		
	} else if (form.m_mail.value == '') {
		alert('INPUT MAIL');
		form.m_mail.focus();
		
	} else if (form.m_phone.value == '') {
		alert('INPUT PHONE');
		form.m_phone.focus();
		
	} else if (form.m_main_addr.value == '') {
		alert('INPUT MAIN ADDRESS');
		form.m_main_addr.focus();
		
	} else if (form.m_detail_addr.value == '') {
		alert('INPUT DETAIL ADDRESS');
		form.m_detail_addr.focus();
		
	} else {
		form.submit();
		
	}
	
}

function init_events() {
	console.log('init_events() CALLED!!');
	
	$('#section_wrap .delete_account a').click(function() {
		console.log('delete_account CLICK HANDLER!!');
		
		let result = confirm('정말 탈퇴 하시겠습니까?');

		if (result)
			ajax_deleteAccount();
		
	});
	
}

function ajax_deleteAccount() {
	console.log('ajax_deleteAccount() CALLED!!');

	let msg = {
		'm_no' : [[${session.loginedMemberDto}]].m_no
	};
	$.ajax({
		url:			'/member/member_delete_confirm',
		type:			'POST',
		data: 			JSON.stringify(msg),
		contentType:	'application/json; chartset=utf-8;',
		dataType:		'json',
		success:		function(data) {
			console.log('AJAX SUCCESS - ajax_deleteAccount()');
			
			if (data.result >= 1) {
				alert('계정 삭제가 완료되었습니다. 메인화면으로 돌아갑니다.');
				location.href = "/";
			}
			
		},
		error:			function(data) {
			console.log('AJAX ERROR - ajax_deleteAccount()');
			alert('삭제에 실패하였습니다. 다시 시도해주세요.');
			
		}
		
	});
	
}

</script>